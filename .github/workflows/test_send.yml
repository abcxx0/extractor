name: üì§ Test env√≠o newsletter

on:
  workflow_dispatch:        # se lanza manualmente

jobs:
  send:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-python@v4
        with:
          python-version: '3.10'

      - name: Instalar deps m√≠nimas
        run: pip install markdown jinja2 premailer

      # --- Genera un markdown de prueba (o usa uno ya existente) ---
      - name: Crear demo.md
        run: |
          echo "# Test env√≠o" > demo.md
          echo "Env√≠o r√°pido desde Actions." >> demo.md

      # --- Renderiza y env√≠a ---
      - name: Enviar correo de prueba
        env:
          SMTP_USER: ${{ secrets.SMTP_USER }}
          SMTP_PASS: ${{ secrets.SMTP_PASS }}
        run: |
          python enviar_newsletter.py --md demo.md
